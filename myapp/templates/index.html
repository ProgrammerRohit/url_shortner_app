{% extends 'base.html' %}
<!--- --->
{% block content %}
<div class="container">
  <div class="border border-1 bg-white mx-auto mt-5 p-5" style="width: 45%">
    {% if short_url %}
    <p class="alert alert-success text-center">Short URL Generated!</p>
    {% endif %}
    <h3 class="text-center">URL Shotener app</h3>
    <form action="" method="POST">
      {% csrf_token %}
      <input
        type="url"
        placeholder="Enter Long URL Here"
        name="url"
        value="{{url}}"
        class="form-control form-control-lg mt-5"
      />
      <div class="d-grid mt-2">
        <input type="submit" class="btn btn-lg btn-info text-white" />
      </div>
    </form>
  </div>
  {% if short_url %}
  <div class="container">
    <div
      class="boder border-1 bg-white mx-auto mt-5 p-2 d-flex justify-content-between align-item-center"
      style="width: 45%"
    >
      <p id="short_url">{{short_url}}</p>
      <span style="cursor: pointer" onclick="shortUrl()">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          fill="currentColor"
          class="bi bi-copy"
          viewBox="0 0 16 16"
        >
          <path
            fill-rule="evenodd"
            d="M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM2 5a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-1h1v1a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h1v1z"
          />
        </svg>
      </span>
    </div>
    <div class="mx-auto mt-1" style="width: 45%">
      <a href="" class="btn btn-sm btn-success"
        ><svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          fill="currentColor"
          class="bi bi-arrow-clockwise"
          viewBox="0 0 16 16"
        >
          <path
            fill-rule="evenodd"
            d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2z"
          />
          <path
            d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466"
          />
        </svg>
        Reload</a
      >
    </div>
    {% endif %}
  </div>
</div>

<script>
  function shortUrl() {
    var short_url = document.getElementById("short_url").innerText;
    window.navigator.clipboard
      .writeText(short_url)
      .then(() => {
        alert("Short Url copied to clipboard");
      })
      .catch((err) => {
        console.log("Failed to copy", err);
        window.alert("Failed to copy the Short Url");
      });
  }
</script>
{% endblock content %}
